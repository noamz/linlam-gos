# generating functions for sequent calculus presentation of Tamari order

R.<x,z> = ZZ[]

max = 40
G = Sequence([0..max],R)
D = Sequence([0..max],R)

for i in range(max):
    D[i+1] = x + z*D[i]*G[i]
    D[i+1] = D[i+1].truncate(z,max)
    G[i+1] = x*(D[i+1] - D[i+1].subs(x=1))/(x-1)
#    G[i+1] = (G[i] - x*G[i].coefficient({x:1}))/x + D[i+1]
    G[i+1] = G[i+1].truncate(z,max)

DD = D[max].truncate(z,max)
   
DD.subs(x=1)
# 5157679757210166896047095056322100*z^39 + 579765709301805935715699759959400*z^38 + 65279164593636661064677738197740*z^37 + 7363078915275373267621749900080*z^36 + 832049648783172760908539918940*z^35 + 94208404652953355082470864580*z^34 + 10688835346529297517134514940*z^33 + 1215417968069890187390670300*z^32 + 138527083005463129610280725*z^31 + 15827868548437082733879976*z^30 + 1813260799116658123072932*z^29 + 208318056954199178840392*z^28 + 24005427634602793982722*z^27 + 2775265555241813680074*z^26 + 321973371914323166604*z^25 + 37495248874510995828*z^24 + 4384387181372914755*z^23 + 514956972502029690*z^22 + 60776550501588855*z^21 + 7211115497448720*z^20 + 860593023907540*z^19 + 103367824774012*z^18 + 12504654858828*z^17 + 1524813969276*z^16 + 187606350645*z^15 + 23317105140*z^14 + 2931682810*z^13 + 373537388*z^12 + 48336171*z^11 + 6369883*z^10 + 857956*z^9 + 118668*z^8 + 16965*z^7 + 2530*z^6 + 399*z^5 + 68*z^4 + 13*z^3 + 3*z^2 + z + 1

derivative(DD,x).subs(x=1)
# 31045554248112798434828573536550972*z^39 + 3480349805839971918921613333426592*z^38 + 390762722748110922373476369325472*z^37 + 43944517558967297298681517883712*z^36 + 4950339525293589339790214112492*z^35 + 558655957641788419059259211232*z^34 + 63165062197010633915059204472*z^33 + 7156162347144712981994513792*z^32 + 812467910983674630347215387*z^31 + 92451054599161671281994336*z^30 + 10545312045609141133526064*z^29 + 1205916902355344165301408*z^28 + 138280582267202539389506*z^27 + 15902829317466689142752*z^26 + 1834635081229067450888*z^25 + 212368658394052099040*z^24 + 24672447821197834553*z^23 + 2877697636252004168*z^22 + 337082395954643168*z^21 + 39669049950811328*z^20 + 4692269111973668*z^19 + 558146870481760*z^18 + 66803956281592*z^17 + 8050816106176*z^16 + 977709717091*z^15 + 119763949936*z^14 + 14814453896*z^13 + 1853076528*z^12 + 234798627*z^11 + 30201504*z^10 + 3954488*z^9 + 528992*z^8 + 72647*z^7 + 10312*z^6 + 1528*z^5 + 240*z^4 + 41*z^3 + 8*z^2 + 2*z + 1

DD.polynomial(z).truncate(max/2)
# (1767263190*x^20 + 15905368710*x^19 + 77138650050*x^18 + 267586846560*x^17 + 743836982625*x^16 + 1760661410760*x^15 + 3683222721360*x^14 + 6980466696000*x^13 + 12194405002780*x^12 + 19882182069750*x^11 + 30529293447510*x^10 + 44432213578896*x^9 + 61545918679245*x^8 + 81284313900636*x^7 + 102244420000800*x^6 + 121784464712064*x^5 + 135277629836412*x^4 + 134519771966180*x^3 + 103367824774012*x^2)*z^19 + (477638700*x^19 + 4059928950*x^18 + 18668849760*x^17 + 61610739975*x^16 + 163416307320*x^15 + 370015460100*x^14 + 742041207600*x^13 + 1350514997832*x^12 + 2268651676200*x^11 + 3559857361060*x^10 + 5262051194400*x^9 + 7368102767025*x^8 + 9801223583580*x^7 + 12382019142570*x^6 + 14778966163752*x^5 + 16421073515280*x^4 + 16310419381080*x^3 + 12504654858828*x^2)*z^18 + (129644790*x^18 + 1037158320*x^17 + 4508102925*x^16 + 14115694320*x^15 + 35636913000*x^14 + 77012282760*x^13 + 147732098514*x^12 + 257640394440*x^11 + 415220449644*x^10 + 625442818000*x^9 + 887209032710*x^8 + 1190292863760*x^7 + 1511405695800*x^6 + 1808402199660*x^5 + 2010068042625*x^4 + 1993987498284*x^3 + 1524813969276*x^2)*z^17 + (35357670*x^17 + 265182525*x^16 + 1085822640*x^15 + 3216014100*x^14 + 7706844600*x^13 + 15854466628*x^12 + 29019121040*x^11 + 48370136958*x^10 + 74580114180*x^9 + 107483105730*x^8 + 145691385840*x^7 + 186127769100*x^6 + 223353322920*x^5 + 248377859100*x^4 + 246041115600*x^3 + 187606350645*x^2)*z^16 + (9694845*x^16 + 67863915*x^15 + 260757900*x^14 + 728042000*x^13 + 1650887238*x^12 + 3223471524*x^11 + 5613072036*x^10 + 8914574240*x^9 + 13103365275*x^8 + 17986968714*x^7 + 23150207388*x^6 + 27878644080*x^5 + 31021294850*x^4 + 30680401500*x^3 + 23317105140*x^2)*z^15 + (2674440*x^15 + 17383860*x^14 + 62403600*x^13 + 163601438*x^12 + 349776700*x^11 + 645999354*x^10 + 1066411632*x^9 + 1607458710*x^8 + 2241753228*x^7 + 2911858950*x^6 + 3521923944*x^5 + 3922142574*x^4 + 3872033900*x^3 + 2931682810*x^2)*z^14 + (742900*x^14 + 4457400*x^13 + 14872858*x^12 + 36447320*x^11 + 73163376*x^10 + 127287160*x^9 + 198333135*x^8 + 282285432*x^7 + 370952010*x^6 + 451137596*x^5 + 502957455*x^4 + 495508780*x^3 + 373537388*x^2)*z^13 + (208012*x^13 + 1144066*x^12 + 3527160*x^11 + 8036886*x^10 + 15072200*x^9 + 24576552*x^8 + 35939904*x^7 + 47948670*x^6 + 58727214*x^5 + 65572325*x^4 + 64448228*x^3 + 48336171*x^2)*z^12 + (58786*x^12 + 293930*x^11 + 831402*x^10 + 1750320*x^9 + 3048045*x^8 + 4628052*x^7 + 6301680*x^6 + 7791168*x^5 + 8717940*x^4 + 8544965*x^3 + 6369883*x^2)*z^11 + (16796*x^11 + 75582*x^10 + 194480*x^9 + 375375*x^8 + 602316*x^7 + 844074*x^6 + 1057224*x^5 + 1186680*x^4 + 1159400*x^3 + 857956*x^2)*z^10 + (4862*x^10 + 19448*x^9 + 45045*x^8 + 78936*x^7 + 115500*x^6 + 147420*x^5 + 166257*x^4 + 161820*x^3 + 118668*x^2)*z^9 + (1430*x^9 + 5005*x^8 + 10296*x^7 + 16170*x^6 + 21252*x^5 + 24150*x^4 + 23400*x^3 + 16965*x^2)*z^8 + (429*x^8 + 1287*x^7 + 2310*x^6 + 3192*x^5 + 3675*x^4 + 3542*x^3 + 2530*x^2)*z^7 + (132*x^7 + 330*x^6 + 504*x^5 + 595*x^4 + 570*x^3 + 399*x^2)*z^6 + (42*x^6 + 84*x^5 + 105*x^4 + 100*x^3 + 68*x^2)*z^5 + (14*x^5 + 21*x^4 + 20*x^3 + 13*x^2)*z^4 + (5*x^4 + 5*x^3 + 3*x^2)*z^3 + (2*x^3 + x^2)*z^2 + x^2*z + x

GG.polynomial(z).truncate(max/2)
# (1767263190*x^20 + 17672631900*x^19 + 94811281950*x^18 + 362398128510*x^17 + 1106235111135*x^16 + 2866896521895*x^15 + 6550119243255*x^14 + 13530585939255*x^13 + 25724990942035*x^12 + 45607173011785*x^11 + 76136466459295*x^10 + 120568680038191*x^9 + 182114598717436*x^8 + 263398912618072*x^7 + 365643332618872*x^6 + 487427797330936*x^5 + 622705427167348*x^4 + 757225199133528*x^3 + 860593023907540*x^2 + 860593023907540*x)*z^19 + (477638700*x^19 + 4537567650*x^18 + 23206417410*x^17 + 84817157385*x^16 + 248233464705*x^15 + 618248924805*x^14 + 1360290132405*x^13 + 2710805130237*x^12 + 4979456806437*x^11 + 8539314167497*x^10 + 13801365361897*x^9 + 21169468128922*x^8 + 30970691712502*x^7 + 43352710855072*x^6 + 58131677018824*x^5 + 74552750534104*x^4 + 90863169915184*x^3 + 103367824774012*x^2 + 103367824774012*x)*z^18 + (129644790*x^18 + 1166803110*x^17 + 5674906035*x^16 + 19790600355*x^15 + 55427513355*x^14 + 132439796115*x^13 + 280171894629*x^12 + 537812289069*x^11 + 953032738713*x^10 + 1578475556713*x^9 + 2465684589423*x^8 + 3655977453183*x^7 + 5167383148983*x^6 + 6975785348643*x^5 + 8985853391268*x^4 + 10979840889552*x^3 + 12504654858828*x^2 + 12504654858828*x)*z^17 + (35357670*x^17 + 300540195*x^16 + 1386362835*x^15 + 4602376935*x^14 + 12309221535*x^13 + 28163688163*x^12 + 57182809203*x^11 + 105552946161*x^10 + 180133060341*x^9 + 287616166071*x^8 + 433307551911*x^7 + 619435321011*x^6 + 842788643931*x^5 + 1091166503031*x^4 + 1337207618631*x^3 + 1524813969276*x^2 + 1524813969276*x)*z^16 + (9694845*x^16 + 77558760*x^15 + 338316660*x^14 + 1066358660*x^13 + 2717245898*x^12 + 5940717422*x^11 + 11553789458*x^10 + 20468363698*x^9 + 33571728973*x^8 + 51558697687*x^7 + 74708905075*x^6 + 102587549155*x^5 + 133608844005*x^4 + 164289245505*x^3 + 187606350645*x^2 + 187606350645*x)*z^15 + (2674440*x^15 + 20058300*x^14 + 82461900*x^13 + 246063338*x^12 + 595840038*x^11 + 1241839392*x^10 + 2308251024*x^9 + 3915709734*x^8 + 6157462962*x^7 + 9069321912*x^6 + 12591245856*x^5 + 16513388430*x^4 + 20385422330*x^3 + 23317105140*x^2 + 23317105140*x)*z^14 + (742900*x^14 + 5200300*x^13 + 20073158*x^12 + 56520478*x^11 + 129683854*x^10 + 256971014*x^9 + 455304149*x^8 + 737589581*x^7 + 1108541591*x^6 + 1559679187*x^5 + 2062636642*x^4 + 2558145422*x^3 + 2931682810*x^2 + 2931682810*x)*z^13 + (208012*x^13 + 1352078*x^12 + 4879238*x^11 + 12916124*x^10 + 27988324*x^9 + 52564876*x^8 + 88504780*x^7 + 136453450*x^6 + 195180664*x^5 + 260752989*x^4 + 325201217*x^3 + 373537388*x^2 + 373537388*x)*z^12 + (58786*x^12 + 352716*x^11 + 1184118*x^10 + 2934438*x^9 + 5982483*x^8 + 10610535*x^7 + 16912215*x^6 + 24703383*x^5 + 33421323*x^4 + 41966288*x^3 + 48336171*x^2 + 48336171*x)*z^11 + (16796*x^11 + 92378*x^10 + 286858*x^9 + 662233*x^8 + 1264549*x^7 + 2108623*x^6 + 3165847*x^5 + 4352527*x^4 + 5511927*x^3 + 6369883*x^2 + 6369883*x)*z^10 + (4862*x^10 + 24310*x^9 + 69355*x^8 + 148291*x^7 + 263791*x^6 + 411211*x^5 + 577468*x^4 + 739288*x^3 + 857956*x^2 + 857956*x)*z^9 + (1430*x^9 + 6435*x^8 + 16731*x^7 + 32901*x^6 + 54153*x^5 + 78303*x^4 + 101703*x^3 + 118668*x^2 + 118668*x)*z^8 + (429*x^8 + 1716*x^7 + 4026*x^6 + 7218*x^5 + 10893*x^4 + 14435*x^3 + 16965*x^2 + 16965*x)*z^7 + (132*x^7 + 462*x^6 + 966*x^5 + 1561*x^4 + 2131*x^3 + 2530*x^2 + 2530*x)*z^6 + (42*x^6 + 126*x^5 + 231*x^4 + 331*x^3 + 399*x^2 + 399*x)*z^5 + (14*x^5 + 35*x^4 + 55*x^3 + 68*x^2 + 68*x)*z^4 + (5*x^4 + 10*x^3 + 13*x^2 + 13*x)*z^3 + (2*x^3 + 3*x^2 + 3*x)*z^2 + (x^2 + x)*z + x
